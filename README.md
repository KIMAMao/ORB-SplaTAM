# ORB-SplaTAM: Enhancing 3DGS-based SLAM with ORB-based Loop Closure

This project provides guidelines to configure and run the ORB-Splatam environment for pose data generation and training on datasets. It supports datasets like Replica and TUM.

- You can find the code for generating final pose data after loop closure optimization in the ORB-SLAM2 repository.
- For the configuration files related to the Replica dataset in ORB-SLAM2, the Splatam repository includes scripts that utilize the final pose data generated by ORB-SLAM2 to reconstruct scenes.

## 1. Configure the ORB-SPLATAM Environment

### Installation (Ubuntu 22.04)

#### a. Splatam

```bash
conda create -n orb_splatam python=3.10
conda activate orb_splatam
pip install torch==2.1.1 torchvision==0.16.1 torchaudio==2.1.1 --index-url https://download.pytorch.org/whl/cu118
git clone https://github.com/KIMAMao/ORB-SplaTAM.git --recursive
pip install -r requirements.txt
```

#### b. ORB-SLAM2

```bash
cd ORB_SLAM2
chmod +x build.sh
./build.sh
```

## 2. Generation of Pose Data

After configuring the ORB-SPLATAM environment, use the modified ORB-SLAM2 code.

The main program is located in `Examples/RGB-D/rgbd_tum.cc`. Usage:

```bash
rgbd_replica path_to_vocabulary path_to_settings path_to_sequence
```

**Example: Run room0**

```bash
./Examples/RGB-D/rgbd_replica Vocabulary/ORBvoc.txt ./Examples/RcB-D/room0.yaml Replica/room0/
```

The resulting pose path should be copied to the corresponding dataset's scene under the `traj` folder in the `splatam` directory.

Run the `splatam.py` script to train the ORB-SLAM pose data instead of downloading pose data directly from Neural Graph Mapping.

## 3. Run on Data

### a. Run on Replica

#### Download Dataset

```bash
wget https://cvg-data.inf.ethz.ch/nice-slam/data/Replica.zip --no-check-certificate
unzip Replica.zip
```

#### Run Guideline

```bash
python scripts/splatam.py configs/replica/splatam.py
```

#### Adjustments for Replica Dataset

- Modify the pose data path read in the `splatam.py` script in the `scripts` directory to correspond to the replica scene in the `traj` file.
- Modify the `splatam.py` configuration file in the `replica` subfolder within the `configs` folder to ensure that the training scenario path matches the pose text file path.

**Example:** For the `room1` scenario, ensure `configs/replica/splatam.py` and `scripts/replica/splatam.py` point to the `room1` scenario.

### b. Run on TUM

#### Download Dataset

```bash
wget https://vision.in.tum.de/rgbd/dataset/freiburg1/rgbd_dataset_freiburg1_desk.tgz --no-check-certificate
tar -xvzf rgbd_dataset_freiburg1_desk.tgz

wget https://vision.in.tum.de/rgbd/dataset/freiburg2/rgbd_dataset_freiburg2_xyz.tgz --no-check-certificate
tar -xvzf rgbd_dataset_freiburg2_xyz.tgz

wget https://vision.in.tum.de/rgbd/dataset/freiburg3/rgbd_dataset_freiburg3_long_office_household.tgz --no-check-certificate
tar -xvzf rgbd_dataset_freiburg3_long_office_household.tgz
```

#### Run Guideline

```bash
python scripts/splatam.py configs/tum/splatam.py
```

**Note:** Ensure all paths and configuration files are consistent with the dataset being used.
